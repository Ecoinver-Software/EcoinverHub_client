<!-- Overlay para móviles -->
<div
  *ngIf="menuMovilAbierto"
  class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden transition-opacity duration-300"
  (click)="cerrarMenuMovil()"
></div>

<!-- Botón hamburguesa para móviles -->
<button
  (click)="alternarMenuMovil()"
  class="fixed top-4 left-4 z-50 lg:hidden bg-white dark:bg-gray-900 p-2 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 transition-all duration-200"
  [class.hidden]="menuMovilAbierto"
>
  <svg
    class="h-6 w-6 text-gray-700 dark:text-gray-300"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M4 6h16M4 12h16M4 18h16"
    ></path>
  </svg>
</button>

<!-- Sidebar -->
<aside
  class="fixed top-0 left-0 h-screen bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-300 shadow-lg dark:shadow-gray-900/50 flex flex-col transition-all duration-300 ease-in-out border-r border-gray-200 dark:border-gray-700 group z-30"
  [class]="obtenerClasesSidebar()"
>
  <!-- Header con botón de cerrar para móviles -->
  <div
    class="h-16 flex items-center justify-between w-full border-b border-gray-200 dark:border-gray-700 px-4"
  >
    <div class="flex items-center space-x-3 min-w-0">
      <a class="h-6 w-6 flex-shrink-0" href="https://ecoinver.es/">
        <img
          class="h-6 w-6 transition-opacity hover:opacity-80"
          src="../../../assets/aaaaaa.png"
          alt="ecoinver logo"
        />
      </a>
      <div
        class="opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 overflow-hidden"
        [class.opacity-100]="menuMovilAbierto"
      >
        <h2
          class="text-sm font-semibold text-gray-900 dark:text-white whitespace-nowrap"
        >
          Ecoinver Cloud
        </h2>
        <p class="text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap">
          Panel de control
        </p>
      </div>
    </div>

    <!-- Botón cerrar para móviles -->
    <button
      (click)="cerrarMenuMovil()"
      class="lg:hidden p-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded transition-colors duration-200"
    >
      <svg
        class="h-5 w-5"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
        ></path>
      </svg>
    </button>
  </div>

  <!-- Navigation Items -->
  <ul class="flex-1 py-2">
    <!-- Dashboard -->
    <li
      class="hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 mx-2 rounded-lg"
    >
      <a
        (click)="navegarA('/home', $event)"
        class="h-12 px-4 flex items-center w-full text-gray-600 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 focus:text-orange-500 dark:focus:text-orange-400 focus:bg-orange-50 dark:focus:bg-orange-900/20 transition-all duration-200 group/item rounded-lg cursor-pointer"
        [class.bg-orange-50]="esRutaActiva('/home')"
        [class.dark:bg-gray-900]="esRutaActiva('/home')"
        [class.text-orange-500]="esRutaActiva('/home')"
        [class.dark:text-orange-400]="esRutaActiva('/home')"
      >
        <div class="flex items-center space-x-3 min-w-0">
          <svg
            class="h-5 w-5 flex-shrink-0 group-hover/item:scale-110 transition-transform duration-200"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 48 48"
            fill="currentColor"
          >
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g
              id="SVGRepo_tracerCarrier"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></g>
            <g id="SVGRepo_iconCarrier">
              <title>dashboard-tile-setting</title>
              <g id="Layer_2" data-name="Layer 2">
                <g id="invisible_box" data-name="invisible box">
                  <rect width="48" height="48" fill="none"></rect>
                </g>
                <g id="Q3_icons" data-name="Q3 icons">
                  <path
                    d="M39.6,18.7l.9-.2,3.3-.4A7.5,7.5,0,0,0,44,16a7.5,7.5,0,0,0-.2-2.1l-3.3-.4-.9-.2L39,11.9l.5-.8,2-2.7a13.3,13.3,0,0,0-2.9-2.9l-2.7,2-.8.5-1.4-.6-.2-.9-.4-3.3A7.5,7.5,0,0,0,31,3a7.5,7.5,0,0,0-2.1.2l-.4,3.3-.2.9L26.9,8l-.8-.5-2.7-2a13.3,13.3,0,0,0-2.9,2.9l2,2.7.5.8-.6,1.4-.9.2-3.3.4A7.5,7.5,0,0,0,18,16a7.5,7.5,0,0,0,.2,2.1l3.3.4.9.2.6,1.4-.5.8-2,2.7a13.3,13.3,0,0,0,2.9,2.9l2.7-2,.8-.5,1.4.6.2.9.4,3.3A7.5,7.5,0,0,0,31,29a7.5,7.5,0,0,0,2.1-.2l.4-3.3.2-.9,1.4-.6.8.5,2.7,2a13.3,13.3,0,0,0,2.9-2.9l-2-2.7-.5-.8ZM31,20a4,4,0,1,1,4-4A4,4,0,0,1,31,20Z"
                  ></path>
                  <path
                    d="M16,35v6H8V35h8m2-4H6a2,2,0,0,0-2,2V43a2,2,0,0,0,2,2H18a2,2,0,0,0,2-2V33a2,2,0,0,0-2-2Z"
                  ></path>
                  <path
                    d="M18,7h0a2,2,0,0,0-2-2H6A2,2,0,0,0,4,7V25a2,2,0,0,0,2,2H16a2,2,0,0,0,2-2h0a2,2,0,0,0-2-2H8V9h8A2,2,0,0,0,18,7Z"
                  ></path>
                  <path
                    d="M36,33v8H28V33a2,2,0,0,0-2-2h0a2,2,0,0,0-2,2V43a2,2,0,0,0,2,2H38a2,2,0,0,0,2-2V33a2,2,0,0,0-2-2h0A2,2,0,0,0,36,33Z"
                  ></path>
                </g>
              </g>
            </g>
          </svg>
          <span
            class="text-sm font-medium opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 whitespace-nowrap overflow-hidden"
            [class.opacity-100]="menuMovilAbierto"
          >
            Dashboard
          </span>
        </div>
      </a>
    </li>

    <!-- Notificaciones -->
    <li
      class="hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 mx-2 rounded-lg"
    >
      <a
        (click)="navegarA('/anuncios', $event)"
        class="h-12 px-4 flex items-center w-full text-gray-600 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 focus:text-orange-500 dark:focus:text-orange-400 focus:bg-orange-50 dark:focus:bg-orange-900/20 transition-all duration-200 group/item rounded-lg cursor-pointer relative"
        [class.bg-orange-50]="esRutaActiva('/anuncios')"
        [class.dark:bg-gray-900]="esRutaActiva('/anuncios')"
        [class.text-orange-500]="esRutaActiva('/anuncios')"
        [class.dark:text-orange-400]="esRutaActiva('/anuncios')"
      >
        <div class="flex items-center space-x-3 min-w-0">
          <div class="relative">
            <svg
              class="h-5 w-5 flex-shrink-0 group-hover/item:scale-110 transition-transform duration-200"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M22 7.99992V11.9999M10.25 5.49991H6.8C5.11984 5.49991 4.27976 5.49991 3.63803 5.82689C3.07354 6.11451 2.6146 6.57345 2.32698 7.13794C2 7.77968 2 8.61976 2 10.2999L2 11.4999C2 12.4318 2 12.8977 2.15224 13.2653C2.35523 13.7553 2.74458 14.1447 3.23463 14.3477C3.60218 14.4999 4.06812 14.4999 5 14.4999V18.7499C5 18.9821 5 19.0982 5.00963 19.1959C5.10316 20.1455 5.85441 20.8968 6.80397 20.9903C6.90175 20.9999 7.01783 20.9999 7.25 20.9999C7.48217 20.9999 7.59826 20.9999 7.69604 20.9903C8.64559 20.8968 9.39685 20.1455 9.49037 19.1959C9.5 19.0982 9.5 18.9821 9.5 18.7499V14.4999H10.25C12.0164 14.4999 14.1772 15.4468 15.8443 16.3556C16.8168 16.8857 17.3031 17.1508 17.6216 17.1118C17.9169 17.0756 18.1402 16.943 18.3133 16.701C18.5 16.4401 18.5 15.9179 18.5 14.8736V5.1262C18.5 4.08191 18.5 3.55976 18.3133 3.2988C18.1402 3.05681 17.9169 2.92421 17.6216 2.88804C17.3031 2.84903 16.8168 3.11411 15.8443 3.64427C14.1772 4.55302 12.0164 5.49991 10.25 5.49991Z"
              />
            </svg>
          </div>

          <div class="flex items-center justify-between flex-1 min-w-0">
            <span
              class="text-sm font-medium opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 whitespace-nowrap overflow-hidden"
              [class.opacity-100]="menuMovilAbierto"
              >Anuncios</span
            >
          </div>
        </div>
      </a>
    </li>

    <!-- Divisor -->
    <li class="my-2 mx-4">
      <div
        class="h-px bg-gray-200 dark:bg-gray-700 opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300"
        [class.opacity-100]="menuMovilAbierto"
      ></div>
    </li>

    <!-- Ecoinver Hub -->
    <!-- Ecoinver Hub -->
    <li
      class="hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 mx-2 rounded-lg"
    >
      <a
        (click)="navegarA('/apphub', $event)"
        class="h-12 px-4 flex items-center w-full text-gray-600 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 focus:text-orange-500 dark:focus:text-orange-400 focus:bg-orange-50 dark:focus:bg-orange-900/20 transition-all duration-200 group/item rounded-lg cursor-pointer"
        [class.bg-orange-50]="esRutaActiva('/apphub')"
        [class.dark:bg-gray-900]="esRutaActiva('/apphub')"
        [class.text-orange-500]="esRutaActiva('/apphub')"
        [class.dark:text-orange-400]="esRutaActiva('/apphub')"
      >
        <div class="flex items-center space-x-3 min-w-0">
          <!-- SVG personalizado -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 16 16"
            fill="currentColor"
            class="h-5 w-5 flex-shrink-0 group-hover/item:scale-110 transition-transform duration-200"
          >
            <path
              d="M16,7c0,1.7-1.3,3-3,3c-0.3,0-0.5-0.2-0.5-0.5S12.7,9,13,9c1.1,0,2-0.9,2-2s-0.9-2-2-2c-0.1,0-0.3,0-0.4,0.1
             c0,0,0,0,0,0C11.7,5.3,11,6,11,7c0,0.3-0.2,0.5-0.5,0.5S10,7.3,10,7c0-1.3,0.8-2.3,1.9-2.8C11.5,2.4,9.9,1,8,1
             C5.8,1,4,2.8,4,5v0.8C4,6,3.9,6.1,3.7,6.2c-0.2,0.1-0.3,0.1-0.5,0C3,6.1,2.8,6,2.5,6C1.7,6,1,6.7,1,7.5S1.7,9,2.5,9h1
             C3.8,9,4,9.2,4,9.5S3.8,10,3.5,10h-1C1.1,10,0,8.9,0,7.5S1.1,5,2.5,5C2.7,5,2.8,5,3,5.1V5c0-2.8,2.2-5,5-5
             c2.4,0,4.4,1.7,4.9,4c0,0,0,0,0.1,0c0,0,0,0,0.1,0c0,0,0,0,0.1,0C14.7,4,16,5.4,16,7z
             M12,10.5l0,3c0,0,0,0,0,0c0,0,0,0.1,0,0.1c0,0,0,0.1,0,0.1
             c0,0,0,0.1-0.1,0.1c0,0,0,0.1-0.1,0.1c0,0,0,0,0,0l-3,2
             c0,0,0,0,0,0c0,0,0,0,0,0C8.6,16,8.6,16,8.5,16s-0.1,0-0.2-0.1
             c0,0,0,0,0,0c0,0,0,0,0,0l-3-2c0,0,0,0,0,0c0,0-0.1,0-0.1-0.1
             c0,0,0,0-0.1-0.1c0,0,0-0.1,0-0.1c0,0,0-0.1,0-0.1c0,0,0,0,0,0v-3
             c0,0,0,0,0,0c0,0,0,0,0-0.1c0,0,0,0,0,0c0,0,0-0.1,0-0.1c0,0,0,0,0,0
             c0,0,0,0,0,0c0,0,0,0,0,0c0,0,0-0.1,0.1-0.1c0,0,0,0,0,0l3-2
             c0,0,0,0,0,0c0,0,0.1,0,0.1,0c0.1,0,0.1,0,0.2,0c0,0,0,0,0.1,0
             c0.1,0,0.1,0,0.2,0.1c0,0,0,0,0,0l3,2c0,0,0,0,0,0c0,0,0.1,0,0.1,0.1
             c0,0,0,0,0,0c0,0,0,0,0,0c0,0,0,0,0,0c0,0,0,0.1,0,0.1
             C12,10.4,12,10.4,12,10.5z
             M6.4,10.5l2.1,1.4l2.1-1.4L8.5,9.1L6.4,10.5z
             M6,13.2l2,1.3v-1.8l-2-1.3V13.2z
             M9,14.6l2-1.3v-1.8l-2,1.3V14.6z"
            />
          </svg>
          <span
            class="text-sm font-medium opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 whitespace-nowrap overflow-hidden"
            [class.opacity-100]="menuMovilAbierto"
          >
            Ecoinver Hub
          </span>
        </div>
      </a>
    </li>

    <!-- Divisor -->
    <li class="my-2 mx-4">
      <div
        class="h-px bg-gray-200 dark:bg-gray-700 opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300"
        [class.opacity-100]="menuMovilAbierto"
      ></div>
    </li>

    <!-- Configuración -->
    <li
      class="hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 mx-2 rounded-lg"
    >
      <a
        (click)="navegarA('/administracion', $event)"
        class="h-12 px-4 flex items-center w-full text-gray-600 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 focus:text-orange-500 dark:focus:text-orange-400 focus:bg-orange-50 dark:focus:bg-orange-900/20 transition-all duration-200 group/item rounded-lg cursor-pointer"
        [class.bg-orange-50]="esRutaActiva('/administracion')"
        [class.dark:bg-gray-900]="esRutaActiva('/administracion')"
        [class.text-orange-500]="esRutaActiva('/administracion')"
        [class.dark:text-orange-400]="esRutaActiva('/administracion')"
      >
        <div class="flex items-center space-x-3 min-w-0">
          <svg
            class="h-5 w-5 flex-shrink-0 group-hover/item:scale-110 transition-transform duration-200"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="3"></circle>
            <path
              d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
            ></path>
          </svg>
          <span
            class="text-sm font-medium opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 whitespace-nowrap overflow-hidden"
            [class.opacity-100]="menuMovilAbierto"
            >Configuración</span
          >
        </div>
      </a>
    </li>
  </ul>

  <!-- User Profile Section -->
  <div class="border-t border-gray-200 dark:border-gray-700">
    <!-- Perfil de Usuario -->
    <div
      class="hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 mx-2 my-2 rounded-lg"
    >
      <a
        (click)="navegarA('/perfil', $event)"
        class="h-12 px-4 flex items-center w-full text-gray-600 dark:text-gray-400 hover:text-orange-500 dark:hover:text-orange-400 focus:text-orange-500 dark:focus:text-orange-400 focus:bg-orange-50 dark:focus:bg-orange-900/20 transition-all duration-200 group/item rounded-lg cursor-pointer"
        [class.bg-orange-50]="esRutaActiva('/perfil')"
        [class.dark:bg-gray-900]="esRutaActiva('/perfil')"
        [class.text-orange-500]="esRutaActiva('/perfil')"
        [class.dark:text-orange-400]="esRutaActiva('/perfil')"
      >
        <div class="flex items-center space-x-3 min-w-0">
          <div
            class="w-5 h-5 bg-gradient-to-r from-orange-400 to-orange-600 rounded-full flex items-center justify-center flex-shrink-0 group-hover/item:scale-110 transition-transform duration-200"
          >
            <svg
              class="h-3 w-3 text-white"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </div>
          <div
            class="opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 overflow-hidden"
            [class.opacity-100]="menuMovilAbierto"
          >
            <p class="text-sm font-medium whitespace-nowrap">Mi Perfil</p>
            <p
              class="text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap"
            ></p>
          </div>
        </div>
      </a>
    </div>

    <!-- Logout Button -->
    <div
      class="cursor-pointer hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors duration-200 mx-2 mb-2 rounded-lg"
    >
      <button
        (click)="cerrarSesion()"
        [disabled]="navegandoEnProceso"
        class="cursor-pointer h-12 w-full px-4 flex items-center text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 focus:text-red-600 dark:focus:text-red-400 focus:bg-red-50 dark:focus:bg-red-900/20 focus:outline-none transition-all duration-200 group/item rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
      >
        <div class="flex items-center space-x-3 min-w-0">
          <svg
            class="h-5 w-5 flex-shrink-0 group-hover/item:scale-110 transition-transform duration-200"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          <span
            class="cursor-pointer text-sm font-medium opacity-0 group-hover:opacity-100 lg:group-hover:opacity-100 transition-opacity duration-300 delay-100 whitespace-nowrap overflow-hidden"
            [class.opacity-100]="menuMovilAbierto"
          >
            {{  "Cerrar Sesión" }}
          </span>
        </div>
      </button>
    </div>
  </div>
</aside>
